!function(){"use strict";const t=t=>0===(t=String(t)).length?"":(t=((t,...e)=>{let a=(t,e)=>(e.forEach(((e,a)=>{t=t.replace("%"+(a+1)+"$",e)})),t);return void 0===window.i18n||void 0===window.i18n.state.locale.values[t]?a(t,e):a(window.i18n.state.locale.values[t],e)})(t)).replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"}[t]))),e=t=>{let e=new URLSearchParams(window.location.search),a=e.get("sid")?e.get("sid"):"",n=-1==t.indexOf("?")?"?sid="+a:"&sid="+a;return t+n},a=()=>{let t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""},n=t=>{let e=t+"=",a=decodeURIComponent(document.cookie).split(";");for(let t=0;t<a.length;t++){let n=a[t];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""},i={Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n("kenzap_api_key"),"Kenzap-Locale":n("locale")?n("locale"):"en","Kenzap-Header":(()=>{let t=localStorage.hasOwnProperty("header")&&localStorage.hasOwnProperty("header-version")?localStorage.getItem("header-version"):0,e=window.location.hostname+"/"+a()+"/"+n("locale");return e!=n("check")&&(t=0,console.log("refresh")),((t,e,a)=>{let n="";if(a){let t=new Date;t.setTime(t.getTime()+24*a*60*60*1e3),n=";expires="+t.toUTCString()}document.cookie=t+"="+(escape(e)||"")+n+";path=/;domain=.kenzap.cloud"})("check",e,5),t})(),"Kenzap-Token":n("kenzap_token"),"Kenzap-Sid":a()},o=t=>{if(console.log(t),isNaN(t.code)){let e=t;try{e=JSON.stringify(e)}catch(t){}let i=new URLSearchParams;return i.append("cmd","report"),i.append("sid",a()),i.append("token",n("kenzap_token")),i.append("data",e),fetch("https://api-v1.kenzap.cloud/error/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded"},body:i}),void alert("Can not connect to Kenzap Cloud")}if(401===t.code){if(-1!=window.location.href.indexOf("localhost"))return void alert(t.reason);location.href="https://auth.kenzap.com/?app=65432108792785&redirect="+window.location.href}else alert(t.reason)},r=(t,e)=>{if(document.querySelector(t))for(let a of document.querySelectorAll(t))a.removeEventListener("click",e,!0),a.addEventListener("click",e,!0)};function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function l(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return s(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,l=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return r=t.done,t},e:function(t){l=!0,o=t},f:function(){try{r||null==a.return||a.return()}finally{if(l)throw o}}}}var c=function(){var t=new URLSearchParams(window.location.search),e=t.get("page")?t.get("page"):1;return parseInt(e)},d=function(t,e,a){if(void 0!==e){var n=e.limit+e.offset;n>e.total_records&&(n=e.total_records),document.querySelector("#listing_info").innerHTML=t("Showing %1$ to %2$ of %3$ entries",1+e.offset,n,e.total_records);var i=Math.ceil(e.total_records/e.limit);document.querySelector("#listing_paginate").style.display=i<2?"none":"block";var o=c(),r='<ul class="pagination d-flex justify-content-end pagination-flat mb-0">';r+='<li class="paginate_button page-item previous" id="listing_previous"><a href="#" aria-controls="order-listing" data-type="prev" data-page="0" tabindex="0" class="page-link"><span aria-hidden="true">&laquo;</span></li>';for(var s=0;s<i;)(++s>=o-3&&s<=o||s<=o+3&&s>=o)&&(r+='<li class="paginate_button page-item '+(o==s?"active":"")+'"><a href="#" aria-controls="order-listing" data-type="page" data-page="'+s+'" tabindex="0" class="page-link">'+s+"</a></li>");r+='<li class="paginate_button page-item next" id="order-listing_next"><a href="#" aria-controls="order-listing" data-type="next" data-page="2" tabindex="0" class="page-link"><span aria-hidden="true">&raquo;</span></a></li>',r+="</ul>",document.querySelector("#listing_paginate").innerHTML=r;var d,p=l(document.querySelectorAll(".page-link"));try{var u=function(){var t=d.value;t.addEventListener("click",(function(e){var n,o,r,s,l,d=parseInt(c()),p=d;switch(t.dataset.type){case"prev":(d-=1)<1&&(d=1);break;case"page":d=t.dataset.page;break;case"next":(d+=1)>i&&(d=i)}if(window.history.replaceState){var u=window.location.search;n="page",o=d,r=u,s=new RegExp("([?;&])"+n+"[^&;]*[;&]?"),u=((l=r.replace(s,"$1").replace(/&$/,"")).length>2?l+"&":"?")+(o?n+"="+o:""),window.history.replaceState("kenzap-cloud",document.title,window.location.pathname+u)}return p!=d&&a(),e.preventDefault(),!1}))};for(p.s();!(d=p.n()).done;)u()}catch(t){p.e(t)}finally{p.f()}}else document.querySelector("#listing_info").innerHTML=t("no records to display")},p=function(t,e){switch(e){case"Verified":return'<div class="badge bg-dark text-light fw-light">'+t("Verified")+"</div>";case"Paid":return'<div class="badge bg-primary text-light fw-light">'+t("Paid")+"</div>";case"Draft":return'<div class="badge bg-secondary text-light fw-light">'+t("Draft")+"</div>";case"Issued":return'<div class="badge bg-primary text-light fw-light">'+t("Issued")+"</div>";case"Activated":return'<div class="badge bg-success text-light fw-light">'+t("Activated")+"</div>";case"Returned":return'<div class="badge bg-success text-light fw-light">'+t("Returned")+"</div>";case"Canceled":return'<div class="badge bg-secondary text-light fw-light">'+t("Canceled")+"</div>";case"Blocked":return'<div class="badge bg-danger text-light fw-light">'+t("Blocked")+"</div>";case"Expired":return'<div class="badge bg-danger text-light fw-light">'+t("Expired")+"</div>";case"Archived":return'<div class="badge bg-secondary text-dark fw-light">'+t("Archived")+"</div>";default:return'<div class="badge bg-warning text-dark fw-light">'+t("New")+"</div>"}},u=function(t,e){switch(e=m(e),e=(Math.round(100*parseFloat(e))/100).toFixed(2),t.state.settings.currency_symb_loc){case"left":e=t.state.settings.currency_symb+e;break;case"right":e+=t.state.settings.currency_symb}return e},m=function(t){return t=t||0,t=parseFloat(t)},v=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},h={_this:null,renderApplication:function(e,a){var n=document.querySelector(".modal");e.state.modalCont=new bootstrap.Modal(n);var i=a.currentTarget.dataset.index;history.pushState({pageID:"Applications"},"Applications",window.location.pathname+window.location.search+"#editing"),n.addEventListener("hide.bs.modal",(function(t){-1!=window.location.href.indexOf("#editing")&&history.pushState({pageID:"applications"},"Applications",window.location.pathname+window.location.search)})),e.state.applicationSingle=void 0===i?{_id:"new",created:1649831099,updated:1649833845}:e.state.applications[i];var o="";Object.keys(e.state.statuses).forEach((function(t,a){o+='<li><a class="dppi dropdown-item" data-key="'.concat(t,'" href="#">').concat(e.state.statuses[t].text,"</a></li>")}));var s="";e.state.applicationSingle.status||(e.state.applicationSingle.status="New"),e.state.statuses[e.state.applicationSingle.status]||(e.state.applicationSingle.status="New"),s+='\n            <div class="st-modal st-opts mb-3 me-1 me-sm-3 dropdown">\n                <a class="btn btn-sm '.concat(e.state.statuses[e.state.applicationSingle.status].class,' dropdown-toggle order-form" data-id="status" data-type="key" data-value="').concat(e.state.applicationSingle.status,'" href="#" role="button" id="order-status-modal" data-bs-toggle="dropdown" aria-expanded="false" >\n                    ').concat(e.state.statuses[e.state.applicationSingle.status].text,'\n                </a>\n                <ul class="dropdown-menu" aria-labelledby="order-status-modal">\n                    ').concat(o,"\n                </ul>\n            </div>\n            ");var l='\n        <div class="d-flex justify-content-between my-3">\n            '.concat(s,'\n            <a href="#" data-index="0" class="print-order text-success">\n                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-printer" viewBox="0 0 16 16">\n                    <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"></path>\n                    <path d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"></path>\n                </svg>\n            </a>\n        </div>\n        ');n.querySelector(".modal-dialog").classList.add("modal-fullscreen"),n.querySelector(".modal-header .modal-title").innerHTML="<b>SG</b>"+e.state.applicationSingle._id.substr(0,8).toUpperCase(),n.querySelector(".modal-footer .btn-confirm").innerHTML="new"==e.state.applicationSingle._id?t("Create"):t("Update"),n.querySelector(".btn-confirm").dataset.loading=!1,n.querySelector(".modal-footer .btn-secondary").innerHTML=t("Close");var c=l,d={id:{l:t("ID"),classList:"order-form"},FirstName:{l:t("First Name"),e:"text",editable:!0,classList:"order-form"},LastName:{l:t("Last Name"),e:"text",editable:!0,classList:"order-form"},CompanyName:{l:t("Company Name"),e:"text",editable:!0,classList:"order-form"},CompanyReg:{l:t("Company Registration Nr."),e:"text",editable:!0,classList:"order-form"},GeneralList:{l:'<hr class="text-secondary">',e:"GeneralList",editable:!1,classList:"order-form"},Phone:{l:t("Phone"),e:"text",editable:!0,classList:"order-form"},Email:{l:t("Email"),e:"text",editable:!0,classList:"order-form"},Website:{l:t("Website"),e:"text",editable:!0,classList:"order-form"},Street1:{l:t("Street 1"),e:"text",editable:!0,classList:"order-form"},Street2:{l:t("Street 2"),e:"text",editable:!0,classList:"order-form"},Country:{l:t("Country"),e:"text",editable:!0,classList:"order-form"},City:{l:t("City"),e:"text",editable:!0,classList:"order-form"},ZIP:{l:t("ZIP"),e:"text",editable:!0,classList:"order-form"},State:{l:t("State"),e:"text",editable:!0,classList:"order-form"}};for(var p in d)if(void 0!==e.state.applicationSingle[p]){var u=e.state.applicationSingle[p],m=d[p].l;c+='\n            <div class="mb-3 mt-3 order-row keyx-'.concat(p," ").concat("_id"==p||"from"==p?"elipsized":"",'"  >\n                <b>').concat(m,"</b>").concat(h.renderField(e,d[p],u,p),"\n            </div>")}c+="",n.querySelector(".modal-body").innerHTML='<div class="modal-body-cont">'+c+"</div>",e.state.modalCont.show(),h.tableApplicationItemListeners(),h.addApplicationItem(e),r(".print-order",(function(t){t.preventDefault(),(t=>{let e=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(e)})(n.querySelector(".btn-confirm")),e.state.printLink=!0})),e.listeners.modalSuccessBtnFunc=function(t){t.preventDefault(),h.updateApplication(e,i,e.state.applicationSingle._id)},r(".st-modal li a",(function(t){t.preventDefault();var a=document.querySelector("#order-status-modal");a.innerHTML=e.state.statuses[t.currentTarget.dataset.key].text,a.dataset.value=t.currentTarget.dataset.key;Object.keys(e.state.statuses).forEach((function(t){e.state.statuses[t].class.split(" ").forEach((function(t){a.classList.remove(t)}))})),e.state.statuses[t.currentTarget.dataset.key].class.split(" ").forEach((function(t){a.classList.add(t)}))}))},newApplication:function(t){h._this=t,r(".add-order",(function(e){h.renderApplication(t,e)}))},viewApplication:function(t){h._this=t,r(".view-application",(function(e){h.renderApplication(t,e)}))},renderField:function(e,a,n,i){var o="";switch(a.e){case"price":return o='<div data-id="'.concat(i,'" data-type="key-number" class="').concat(a.classList?a.classList:"",' ms-2 d-inline-block" ').concat(a.editable?'contenteditable="true"':"",' data-id="').concat(i,'" data-value="').concat(n,'">').concat(u(e,n),"</div>");case"text":return o='<div data-id="'.concat(i,'" data-type="text" class="').concat(a.classList?a.classList:"",' ms-2 d-inline-block form-control border-0" ').concat(a.editable?'contenteditable="true"':"",' data-id="').concat(i,'">').concat(n,"</div>");case"textarea":return'<textarea type="text" rows="4" class="form-control order-form pv " data-type="textarea" id="'+i+'" value="'+n+'">'+n+"</textarea>";case"GeneralList":for(var r in o='<table class="items order-form mb-5" data-type="items"><tr><th><div class="me-1 me-sm-3">'.concat(t("Nr."),'</div></th><th><div class="me-1 me-sm-3">').concat(t("HS Code"),'</div></th><th><div class="me-1 me-sm-3">').concat(t("Goods"),'</div></th><th class="qty"><div class="me-1 me-sm-3">').concat(t("Qty"),'</div></th><th class="weight"><div class="me-1 me-sm-3">').concat(t("Weight"),'</div></th><th class="tp"><div class="me-1 me-sm-3">').concat(t("Value"),'</div></th><th class="origin"><div class="me-1 me-sm-3">').concat(t("Origin"),"</div></th><th></th></tr>"),n)o+=h.structGeneralListRow(e,r,n,!1);return o+='<tr class="new-item-row">\n                            <td class="tp">\n                                <div class="me-1 me-sm-3">\n                                    <input type="text" value="'.concat(n.length+1,'" autocomplete="off" placeholder=" " class="form-control text-right gen-list-index-new" data-id="" data-index="" >\n                                </div>\n                            </td>\n                            <td class="qty">\n                                <div class="me-1 me-sm-3">\n                                    <input type="text" value="" autocomplete="off" class="form-control text-right edit-qty">\n                                </div>\n                            </td>\n                            <td class="tp">\n                                <div class="me-1 me-sm-3">\n                                    <input type="text" value="" autocomplete="off" class="form-control edit-tp">\n                                </div>\n                            </td>\n                            <td class="tp">\n                                <div class="me-1 me-sm-3">\n                                    <input type="text" value="" autocomplete="off" class="form-control edit-tp">\n                                </div>\n                            </td>\n                            <td class="tp">\n                                <div class="me-1 me-sm-3">\n                                    <input type="text" value="" autocomplete="off" class="form-control edit-tp">\n                                </div>\n                            </td>\n                            <td class="tp">\n                                <div class="me-1 me-sm-3">\n                                    <input type="text" value="" autocomplete="off" class="form-control edit-tp">\n                                </div>\n                            </td>\n                            <td class="tp">\n                                <div class="me-1 me-sm-3">\n                                    <input type="text" value="" autocomplete="off" class="form-control edit-tp">\n                                </div>\n                            </td>\n                            <td class="align-middle text-center"> \n                                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" width="24" height="24" class="bi bi-plus-circle text-success align-middle add-item"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"></path><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"></path></svg>\n                            </td>\n                        </tr>'),o+='</table><div class="item-vars-input mt-3"> </div>';default:return"_id"==i&&(n=n.substr(0,6)),o='<div data-id="'.concat(i,'" data-type="text" class="').concat(a.classList?a.classList:"",' ms-2 d-inline-block" ').concat(a.editable?'contenteditable="true"':"",' data-id="').concat(i,'">').concat(n,"</div>")}},itemOptions:function(e){return'\n\n        <div class="dropdown text-center">\n            <a  href="#" role="button" id="order-item-options" data-id="status" data-value="" data-bs-toggle="dropdown" aria-expanded="false">\n                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical order-item-options" viewBox="0 0 16 16"><path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/></svg>\n            </a>\n            <ul class="dropdown-menu" aria-labelledby="order-item-options" >\n                <li><a class="oio dropdown-item edit-item-note" data-key="edit-item-note" href="#">'.concat(t("Add note"),'</a></li>\n                <li><a class="oio dropdown-item d-none" data-key="edit-item-variation" href="#">').concat(t("Add variation"),'</a></li>\n                <li><a class="oio dropdown-ite d-none" data-key="edit-item-price" href="#">').concat(t("Adjust price"),'</a></li>\n                <li><a class="oio dropdown-item text-danger remove-item" data-key="remove-item" href="#">').concat(t("Remove"),"</a></li>\n            </ul>\n        </div>\n    ")},structApplicationItemTable:function(e,a,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r="",s="";for(var l in n[a].variations){var c="";for(var d in n[a].variations[l].list)c+=n[a].variations[l].list[d].title+" ";r+="<div><b>"+n[a].variations[l].title+"</b> <span>"+c+"</span></div> ",void 0!==n[a].variations[l].note&&n[a].variations[l].note.length>0&&(r+="<div><b>"+t("Note")+"</b> "+n[a].variations[l].note+"</div> ")}return s+='<tr class="order-item-row-active" data-x="'+a+'" data-id="'+n[a].id+'" data-vars="'+v(JSON.stringify(n[a].variations))+'">',s+='<td ><div class="item-title" contenteditable="false" data-value="'+n[a].title+'" data-sdesc="'+(n[a].sdesc?n[a].sdesc:"")+'">'+n[a].title+'</div><div class="item-note text-muted mb-1 '+(0!=n[a].note.length&&"<br>"!=n[a].note||i?"":"d-none")+'" contenteditable="true" data-value="'+n[a].note+'">'+n[a].note+'</div><div class="vars border-primary item-variations my-1 ps-2 text-secondary" data-value="">'+r+'</div></td><td class="qty"><div class="me-1 me-sm-3 item-qty" data-value="'+n[a].qty+'">'+n[a].qty+'</div></td><td class="tp"><div class="me-1 me-sm-3 item-total" data-price="'+n[a].price+'" data-value="'+n[a].total+'" >'+u(e,n[a].total)+'</div><td class="'+(o?"":"d-none")+'">'+h.itemOptions(n[a])+"</td></td>",s+="</tr>"},updateApplication:function(e,n,r){var s=document.querySelector(".modal");if("true"!==s.querySelector(".btn-confirm").dataset.loading){s.querySelector(".btn-confirm").dataset.loading=!0,s.querySelector(".btn-confirm").innerHTML='<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>'+t("Loading..");var c={};c.status=document.querySelector("#order-status-modal").dataset.value;var d,p=l(document.querySelectorAll(".order-form"));try{for(p.s();!(d=p.n()).done;){switch(d.value.dataset.type){case"key":case"key-number":case"text":case"email":case"emails":case"select":case"textarea":case"radio":break;case"GeneralList":var u,m=l(document.querySelectorAll(".order-item-row-active"));try{for(m.s();!(u=m.n()).done;){var v=u.value,h=JSON.parse(v.dataset.vars.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&"));c.items.push({id:v.dataset.id,qty:parseInt(v.querySelector(".item-qty").dataset.value),note:v.querySelector(".item-note").innerHTML,type:"new",index:"0",price:parseFloat(v.querySelector(".item-total").dataset.price),sdesc:v.querySelector(".item-title").dataset.sdesc,title:v.querySelector(".item-title").dataset.value,total:parseFloat(v.querySelector(".item-total").dataset.value),variations:"new"==r?[]:h||[]})}}catch(t){m.e(t)}finally{m.f()}}}}catch(t){p.e(t)}finally{p.f()}"new"!=r&&fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:i,body:JSON.stringify({query:{order:{type:"update",key:"atacarnet-application",sid:a(),id:r,data:c}}})}).then((function(t){return t.json()})).then((function(a){a.success?(e.state.modalCont.hide(),(t=>{if(!document.querySelector(".toast")){let t='\n        <div class="position-fixed bottom-0 p-2 m-4 end-0 align-items-center">\n            <div class="toast hide align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3000">\n                <div class="d-flex">\n                    <div class="toast-body"></div>\n                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n                </div>\n            </div>\n        </div>';document.querySelector("body > div")&&document.querySelector("body > div").insertAdjacentHTML("afterend",t)}let e=new bootstrap.Toast(document.querySelector(".toast"));document.querySelector(".toast .toast-body").innerHTML=t,e.show()})(t("Application updated")),e.getData()):o(a)})).catch((function(t){o(t)}))}},tableApplicationItemListeners:function(t){r(".edit-item-note",(function(t){t.preventDefault();var e=t.currentTarget.parentElement.parentElement.parentElement.parentElement.parentElement.querySelector(".item-note");console.log(e),e.classList.remove("d-none"),e.focus()})),r(".remove-item",(function(t){t.preventDefault(),t.currentTarget.parentElement.parentElement.parentElement.parentElement.parentElement.remove(),h.refreshTotals()}))},refreshTotals:function(){document.querySelector(".order-total")&&document.querySelector(".order-total").remove(),document.querySelector(".keyx-total")&&document.querySelector(".keyx-total").remove(),document.querySelector(".keyx-total_tax")&&document.querySelector(".keyx-total_tax").remove(),document.querySelector(".keyx-total_with_tax")&&document.querySelector(".keyx-total_with_tax").remove();var e,a="",n={total:{title:t("Total"),amount:0},total_with_tax:{title:t("Paid"),amount:0}},i=l(document.querySelectorAll(".item-total"));try{for(i.s();!(e=i.n()).done;){var o=e.value;m(o.dataset.value);n.total.amount+=m(o.dataset.value)}}catch(t){i.e(t)}finally{i.f()}for(var r in n){var s=n[r].title;"total_tax"==r&&(s=h._this.state.settings.tax_display+" ("+h._this.state.settings.tax_rate+"%):"),a+='\n        <div class="mb-3 mt-3 order-row elipsized keyx-'.concat(r,'">\n            <b>').concat(s,'</b><div class="order-form ms-2 d-inline-block" data-id="').concat(r,'" data-type="key-number" data-value="').concat(n[r].amount,'">').concat(u(h._this,n[r].amount),"</div>\n        </div>")}a='<div class="order-total">'.concat(a,"</div>"),document.querySelector(".modal-body-cont").insertAdjacentHTML("beforeend",a)},structGeneralListRow:function(e,a,n,i){var o=n[a];return console.log(o),'\n    <tr>\n        <td class="gen-list-index pe-3 pb-3"><input type="text" value="'.concat(parseInt(a)+1,'" autocomplete="off" data-name="index" class="form-control"></td>\n        <td class="gen-list-group pe-3 pb-3"><input type="text" value="').concat(o.Group,'" autocomplete="off" data-name="Group" class="form-control"></td>\n        <td class="gen-list-name pe-3 pb-3"><textarea type="text" value="" autocomplete="off" data-name="Name" rows="1" class="form-control">').concat(o.Name,'</textarea></td>\n        <td class="gen-list-qty pe-3 pb-3"><input type="text" value="').concat(o.Quantity,'" autocomplete="off" data-name="Quantity" class="form-control text-end"></td>\n        <td class="gen-list-weight pe-3 pb-3">\n            <input type="text" value="').concat(o.Weight,'" autocomplete="off" data-name="Weight" class="form-control d-inline-block" placeholder="" >\n            <select class="form-select text-start d-inline-block" name="WeightUnit" data-value="').concat(o.WeightUnit,'" data-type="select">\n                <option value="g" ').concat("g"==o.WeightUnit?"selected":"",">").concat(t("g"),'</option>\n                <option value="gr" ').concat("gr"==o.WeightUnit?"selected":"",">").concat(t("gr"),'</option>\n                <option value="kg" ').concat("kg"==o.WeightUnit?"selected":"",">").concat(t("kg"),'</option>\n                <option value="t" ').concat("t"==o.WeightUnit?"selected":"",">").concat(t("t"),'</option>\n                <option value="l" ').concat("l"==o.WeightUnit?"selected":"",">").concat(t("l"),'</option>\n                <option value="lt" ').concat("lt"==o.WeightUnit?"selected":"",">").concat(t("lt"),'</option>\n            </select>\n        </td>\n        <td class="gen-list-value pe-3 pb-3"><input type="text" value="').concat(o.Value,'" autocomplete="off" data-name="Value" class="form-control"></td>\n        <td class="gen-list-origin pe-3 pb-3"><input type="text" value="').concat(o.Origin,'" autocomplete="off" data-name="Origin" class="form-control"></td>\n        <td class="pb-3">\n            <div class="dropdown text-center">\n                <a href="#" role="button" id="order-item-options" data-id="status" data-value="" data-bs-toggle="dropdown" aria-expanded="false">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical order-item-options" viewBox="0 0 16 16"><path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"></path></svg>\n                <a>\n                <ul class="dropdown-menu" aria-labelledby="order-item-options">\n                    <li><a class="oio dropdown-item edit-item-note" data-key="edit-item-note" href="#">Add note</a></li>\n                    <li><a class="oio dropdown-item d-none" data-key="edit-item-variation" href="#">Add variation</a></li>\n                    <li><a class="oio dropdown-ite d-none" data-key="edit-item-price" href="#">Adjust price</a></li>\n                    <li><a class="oio dropdown-item text-danger remove-item" data-key="remove-item" href="#">Remove</a></li>\n                </ul>\n            </div>\n        </td>\n    </tr>')},addApplicationItem:function(e){r(".add-item",(function(a){var n=[],i={};i.id=document.querySelector(".edit-item").dataset.id,i.title=document.querySelector(".edit-item").value,i.total=parseFloat(document.querySelector(".edit-tp").value),i.price=parseInt(document.querySelector(".edit-tp").dataset.price),i.qty=parseInt(document.querySelector(".edit-qty").value),i.note="",i.variations=[];var o,r=0,s=l(document.querySelectorAll(".item-vars-input input"));try{for(s.s();!(o=s.n()).done;){var c=o.value,d=r;c.checked&&(i.variations[d]||(i.variations[d]={}),i.variations[d].list||(i.variations[d].list={}),i.variations[d].title||(i.variations[d].title=c.dataset.titlev),i.variations[d].list["_"+c.dataset.index]={title:c.dataset.title,price:parseFloat(c.dataset.price)},i.total+=i.qty*parseFloat(c.dataset.price),r+=1)}}catch(t){s.e(t)}finally{s.f()}if(i.title.length<2)alert(t("Incorrect product data"));else{n.push(i);var p=h.structGeneralListRow(e,0,n,!0);document.querySelector(".new-item-row").insertAdjacentHTML("beforebegin",p),h.tableApplicationItemListeners(),h.refreshTotals(),document.querySelector(".edit-item").value="",document.querySelector(".edit-tp").value="",document.querySelector(".edit-qty").value="",document.querySelector(".item-vars-input").innerHTML="",setTimeout((function(){document.querySelector(".edit-item").focus()}),300)}}))}},f={state:{firstLoad:!0,modalCont:null,settings:{},statuses:[],limit:10},init:function(){f.getData()},getData:function(){f.state.firstLoad&&(()=>{let t=document.querySelector(".loader");t&&(t.style.display="block")})();var t=document.querySelector(".search-cont input")?document.querySelector(".search-cont input").value:"";fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:i,body:JSON.stringify({query:{user:{type:"authenticate",fields:["avatar"],token:n("kenzap_token")},locale:{type:"locale",source:["extension"],key:"atacarnet"},settings:{type:"get",key:"atacarnet-settings",fields:["_id","id","img","status","price","title","updated"]},applications:{type:"find",key:"atacarnet-application",fields:"*",limit:f.state.limit,offset:t.length>0?0:c()*f.state.limit-f.state.limit,search:{field:"title",s:t},sortby:{field:"created",order:"DESC"}}}})}).then((function(t){return t.json()})).then((function(t){(()=>{let t=document.querySelector(".loader");t&&(t.style.display="none")})(),t.success?((t=>{if(t.header&&localStorage.setItem("header",t.header),!document.querySelector("#k-script")){let t=document.createElement("div");t.innerHTML=localStorage.getItem("header"),t=t.firstChild,document.body.prepend(t),Function(document.querySelector("#k-script").innerHTML).call("test")}t.locale&&window.i18n.init(t.locale)})(t),f.loadPageStructure(),f.renderPage(t),f.initListeners(),f.initPagination(t),f.initFooter(),f.state.firstLoad=!1):o(t)})).catch((function(t){o(t)}))},authUser:function(t){t.user&&t.user.success},loadPageStructure:function(){f.state.firstLoad&&(document.querySelector("#contents").innerHTML=function(t){return'\n    <div class="container">\n\n        <div class="d-md-flex justify-content-between bd-highlight mb-3">\n            <nav class="bc" aria-label="breadcrumb"></nav>\n            <button class="btn btn-primary btn-add mt-3 mb-1 mt-md-0 mb-md-0" type="button">'.concat(t("New application"),'</button>\n        </div>\n\n        <div class="row">\n            <div class="col-md-12 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card">\n                <div class="card border-white shadow-sm border-0">\n                    <div class="card-body p-0">\n                        <div class="no-footer">\n                            <div class="row">\n                                <div class="col-sm-12">\n                                    <div class="table-responsives">\n                                        <table class="table table-hover table-borderless align-middle table-striped table-p-list mb-0" style="min-width: 800px;">\n                                            <thead>\n\n                                            </thead>\n                                            <tbody>\n\n                                            </tbody>\n                                        </table>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div class="row my-2">\n                                <div class="col-sm-12 col-md-5 d-flex align-items-center">\n                                    <div class="dataTables_info mx-2 text-secondary fw-lighter " id="listing_info"\n                                        role="status" aria-live="polite">&nbsp;</div>\n                                </div>\n                                <div class="col-sm-12 col-md-7">\n                                    <div class="dataTables_paginate paging_simple_numbers m-2" id="listing_paginate">\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class="modal" tabindex="-1">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title"></h5>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary btn-confirm btn-modal"></button>\n                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"></button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class="position-fixed bottom-0 p-2 m-4 end-0 align-items-center">\n        <div class="toast hide align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive"\n            aria-atomic="true" data-bs-delay="3000">\n            <div class="d-flex">\n                <div class="toast-body"></div>\n                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"\n                    aria-label="Close"></button>\n            </div>\n        </div>\n    </div>\n    \n    ')}(__))},renderPage:function(t){if(f.state.firstLoad&&((t=>{let e='<ol class="breadcrumb mt-2 mb-0">';for(let a of t)void 0===a.link?e+=`<li class="breadcrumb-item">${a.text}</li>`:e+=`<li class="breadcrumb-item"><a href="${a.link}">${a.text}</a></li>`;e+="</ol>",document.querySelector(".bc").innerHTML=e})([{link:e("https://dashboard.kenzap.cloud"),text:__("Dashboard")},{link:e("/"),text:__("ATA Carnet System")},{text:__("Applications")}]),f.state.statuses={New:{text:__("New"),class:"btn-warning text-dark fw-light"},Verified:{text:__("Verified"),class:"bg-dark text-light"},Paid:{text:__("Paid"),class:"btn-primary fw-light"},Canceled:{text:__("Canceled"),class:"btn-secondary fw-light"}},document.querySelector(".table thead").innerHTML='\n                <tr>\n                    <th>\n                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#212529" class="bi justify-content-end bi-search mb-1 me-2" viewBox="0 0 16 16" >\n                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path>\n                        </svg>\n                        <div class="search-cont input-group input-group-sm mb-0 justify-content-start">     \n                            <input type="text" placeholder="'.concat(__("Search applications"),'" class="form-control border-top-0 border-start-0 border-end-0 rounded-0" aria-label="').concat(__("Search products"),'" aria-describedby="inputGroup-sizing-sm" style="min-width:160px;max-width: 200px;">\n                        </div>\n                        <span>').concat(__("From"),"</span>\n                    </th>\n                    <th>").concat(__("ID"),"</th>\n                    <th>").concat(__("Lifecycle"),"</th>\n                    <th>").concat(__("Value"),"</th>\n                    <th>").concat(__("Last change"),"</th>\n                    <th></th>\n                </tr>")),0!=t.applications.length){(()=>{let t=new URLSearchParams(window.location.search);t.get("sid")&&t.get("sid")})(),f.state.applications=t.applications,f.state.settings=t.settings;var n,i="";for(var o in t.applications)i+='\n                <tr>\n                    <td class="destt" style="max-width:250px;min-width:250px;">\n                        <div class="my-1"> \n                            <a href="#" data-id="'.concat(t.applications[o]._id,'" data-index="').concat(o,'" class="text-body view-application" style="text-decoration:none;" ><b>').concat(t.applications[o].FirstName," ").concat(t.applications[o].LastName,"</b> ").concat(t.applications[o].CompanyName?'<div class="mt-0" style="font-size:12px;">'+t.applications[o].CompanyName+" ("+t.applications[o].CompanyReg+")</div>":""," </a>\n                        </div>\n                    </td>\n                    <td>\n                        ").concat("<b>SG</b>"+t.applications[o]._id.substr(0,8).toUpperCase(),"\n                    </td>\n                    <td>\n                        <span>").concat(p(__,t.applications[o].status),"</span>\n                    </td>\n                    <td>\n                        <span>","2500.00 SGD","</span>\n                    </td>\n                    <td>\n                        <span>").concat((__,n=t.applications[o].updated,new Date(1e3*parseInt(n)).toLocaleDateString()),'</span>\n                    </td>\n                    <td class="text-end">\n                        <div class="dropdown">\n         \n                            <svg id="dropdownMenuButton1" data-bs-toggle="dropdown" data-boundary="viewport" aria-expanded="false" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-three-dots-vertical dropdown-toggle" viewBox="0 0 16 16">\n                                <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>\n                            </svg>\n              \n                            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">\n                                <li><a class="dropdown-item po view-application" href="#" data-id="').concat(t.applications[o]._id,'" data-index="').concat(o,'">').concat(__("Application"),'</a></li>\n                                <li><a class="dropdown-item" target="_blank" href="https://api-v1.kenzap.cloud/atacarnet/invoice/?sid=').concat(a(),"&id=").concat(t.applications[o]._id,'">').concat(__("Print Invoice"),'</a></li>\n                                <li><a class="dropdown-item po email-invoice" href="#" data-id="').concat(t.applications[o]._id,'" data-index="').concat(o,'">').concat(__("Email Invoice"),'</a></li>\n                                <li><hr class="dropdown-divider"></li>\n                                <li><a class="dropdown-item" target="_blank" href="https://api-v1.kenzap.cloud/atacarnet/?sid=').concat(a(),"&id=").concat(t.applications[o]._id,'">').concat(__("Print Carnet"),'</a></li>\n                                <li><a class="dropdown-item" target="_blank" href="https://api-v1.kenzap.cloud/atacarnet/?sid=').concat(a(),"&id=").concat(t.applications[o]._id,'">').concat(__("Email Carnet"),'</a></li>\n                                <li><a class="dropdown-item po issue-carnet" href="#" data-id="').concat(t.applications[o]._id,'" data-index="').concat(o,'">').concat(__("Issue Carnet"),'</a></li>\n                                <li><hr class="dropdown-divider"></li>\n                                <li><a class="dropdown-item remove-application" href="#">').concat(__("Move to trash"),'</a></li>\n                            </ul>\n                        </div>\n\n\n                        <a href="#" data-id="').concat(t.applications[o]._id,'" class="remove-application text-danger me-2 d-none">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">\n                                <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>\n                                <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>\n                            </svg>\n                        </a>\n                    </td>\n                </tr>');document.querySelector(".table tbody").innerHTML=i}else document.querySelector(".table tbody").innerHTML='<tr><td colspan="6">'.concat(__("No applications to display."),"</td></tr>")},initListeners:function(){h.viewApplication(f),r(".remove-product",f.listeners.removeProduct),r(".table-p-list .bi-search",f.listeners.searchProductsActivate),f.state.firstLoad&&(r(".btn-add",f.addProduct),r(".btn-modal",f.listeners.modalSuccessBtn))},listeners:{viewApplication:function(t){},removeProduct:function(t){t.preventDefault(),confirm(__("Completely remove this product?"))&&fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:i,body:JSON.stringify({query:{product:{type:"delete",key:"ecommerce-product",id:t.currentTarget.dataset.id}}})}).then((function(t){return t.json()})).then((function(t){t.success?f.getData():o(t)})).catch((function(t){o(t)}))},searchProductsActivate:function(t){t.preventDefault(),document.querySelector(".table-p-list thead tr th:nth-child(1) span").style.display="none",document.querySelector(".table-p-list thead tr th:nth-child(1) .search-cont").style.display="flex",document.querySelector(".table-p-list thead tr th:nth-child(1) .search-cont input").focus(),((t,e)=>{if(document.querySelector(t))for(let a of document.querySelectorAll(t))a.removeEventListener("keyup",e,!0),a.addEventListener("keyup",e,!0)})(".table-p-list thead tr th:nth-child(1) .search-cont input",f.listeners.searchProducts)},searchProducts:function(t){t.preventDefault(),f.getData()},modalSuccessBtn:function(t){console.log("calling modalSuccessBtnFunc"),f.listeners.modalSuccessBtnFunc(t)},modalSuccessBtnFunc:null},addProduct:function(t){var a=document.querySelector(".modal"),n=new bootstrap.Modal(a);a.querySelector(".modal-title").innerHTML=__("Add Application"),a.querySelector(".btn-primary").innerHTML=__("Add"),a.querySelector(".btn-secondary").innerHTML=__("Cancel");var r='        <div class="form-cont">            <div class="form-group mb-3">                <label for="p-title" class="form-label">'.concat(__("Title"),'</label>                <input type="text" class="form-control" id="p-title" autocomplete="off" placeholder="" value="').concat("",'">            </div>            <div class="form-group mb-3">                <label for="p-sdesc" class="form-label">').concat(__("Short description"),'</label>                <input type="text" class="form-control" id="p-sdesc" autocomplete="off" placeholder="" value="').concat("",'">            </div>            <div class="form-group mb-3">                <label for="p-price" class="form-label">').concat(__("Price"),'</label>                <input type="text" class="form-control" id="p-price" autocomplete="off" placeholder="" value="').concat("",'">            </div>        </div>');a.querySelector(".modal-body").innerHTML=r,f.listeners.modalSuccessBtnFunc=function(t){t.preventDefault();var n={};n.title=a.querySelector("#p-title").value,n.sdesc=a.querySelector("#p-sdesc").value,n.price=a.querySelector("#p-price").value,n.status="0",n.img=[],n.cats=[],n.title.length<2?alert(__("Please provide longer title")):fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:i,body:JSON.stringify({query:{product:{type:"create",key:"ecommerce-product",data:n}}})}).then((function(t){return t.json()})).then((function(t){t.success?window.location.href=e("/product-edit/?id=".concat(t.product.id)):o(t)})).catch((function(t){o(t)}))},n.show(),setTimeout((function(){return a.querySelector("#p-title").focus()}),100)},initPagination:function(t){d(__,t.meta,f.getData)},initFooter:function(){var t,e;t=__("Created by %1$Kenzap%2$. ❤️ Licensed %3$GPL3%4$.",'<a class="text-muted" href="https://kenzap.com/" target="_blank">',"</a>",'<a class="text-muted" href="https://github.com/kenzap/ecommerce" target="_blank">',"</a>"),e="",document.querySelector("footer .row").innerHTML=`\n    <div class="d-sm-flex justify-content-center justify-content-sm-between">\n        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">${t}</span>\n        <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted">${e}</span>\n    </div>`}};f.init()}();
